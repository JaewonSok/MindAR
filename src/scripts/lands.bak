const numberOfLands = 51;
AFRAME.registerComponent('land-tick', {
    init() {

    },
    tick(time, timeDelta){

        // console.log('checking land position');
        for(let k = 1; k < numberOfLands; k++){
            var land = document.querySelector(`#land${k}`);
            var landPosition = land.getAttribute('position');
            var landx = landPosition.x;
            if (landx < -50){
                var newLandPosition = 483;
                land.setAttribute('position', {x: newLandPosition, y: 0.1, z: -3});
                console.log(`land${k} reset to ${newLandPosition}}`);
            }
        }
    }
  
});




console.log("lands.js loaded");
function getRandomInt(min, max) {
    min = Math.ceil(min);
    max = Math.floor(max);
    return Math.floor(Math.random() * (max - min + 1)) + min;
}

function terraForm() {   
var previousland = 1;
var landnum = 1
var nextXLocation = 0
    for(let k = 1; k < numberOfLands; k++){
        while(landnum == previousland)
        {landnum = getRandomInt(1,7); console.log("landID changed loop");}
      
        switch(landnum){
            case 1: landsize = 8; break;
            case 2: landsize = 8; break;
            case 3: landsize = 10; break;
            case 4: landsize = 10; break;
            case 5: landsize = 10; break;
            case 6: landsize = 14; break;
            case 7: landsize = 14; break;
        }
        nextXLocation += (landsize/2 + 5);
        landBuild(k, landnum, nextXLocation)
        previousland = landnum;
    }
   
}


function landBuild(id, landnumber, x){  
const game = document.querySelector('#game');
var halfextents = "";
switch(landnumber){
    case 1:halfextents = "x: 4, y: 2, z: 4"; break;
    case 2:halfextents = "x: 4, y: 2, z: 4"; break;
    case 3:halfextents = "x: 6, y: 4, z: 6"; break;
    case 4:halfextents = "x: 8, y: 8, z: 8"; break;
    case 5:halfextents = "x: 8, y: 8, z: 8"; break;
    case 6:halfextents = "x: 10, y: 10, z: 10"; break;
    case 7:halfextents = "x: 10, y: 10, z: 10"; break;
}
const land = document.createElement('a-entity');
land.setAttribute('id', `land${id}`);
land.setAttribute('gltf-model', `#${landnumber}`);
land.setAttribute('position', {x: x, y: 0.1, z: -10});
land.setAttribute('ammo-body', {type: 'kinematic', emitCollisionEvents: true});
land.setAttribute('ammo-shape', {type: 'box', fit: 'manual', halfExtents: `${halfextents}`, offset: {x: 0, y: 1, z: 0}});
land.setAttribute('activationState','active')
land.setAttribute('animation',{property: 'position', to: '-999 0 0', loop: false, dur: 100000});
game.appendChild(land);
console.log(`land${id} added with land ${landnumber} at location x = ${x}`);

}
terraForm();


 