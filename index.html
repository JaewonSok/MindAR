<html>
	<head>
		<!--Import A-Frame-->
		<script src="https://aframe.io/releases/1.4.1/aframe.min.js"></script>
		<script src="https://unpkg.com/aframe-event-set-component@3.0.3/dist/aframe-event-set-component.min.js"></script>
		<script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v6.1.1/dist/aframe-extras.min.js"></script>
		<script src="https://unpkg.com/aframe-environment-component@1.3.1/dist/aframe-environment-component.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/mind-ar@1.2.1/dist/mindar-image-aframe.prod.js"></script>
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<script src="./photo-game.js"></script>
		<script>
			document.addEventListener("DOMContentLoaded", function () {
				const sceneEl = document.querySelector("a-scene")
				const arSystem = sceneEl.systems["mindar-image-system"]
				const exampleTarget = document.querySelector("#marker")

				const buttonFlower =
					// arReady event triggered when ready
					sceneEl.addEventListener("arReady", (event) => {
						// console.log("MindAR is ready")
					})
				// arError event triggered when something went wrong. Mostly browser compatbility issue
				sceneEl.addEventListener("arError", (event) => {
					// console.log("MindAR failed to start")
				})
				// detect target found
				exampleTarget.addEventListener("targetFound", (event) => {
					console.log("target found")
				})
				// detect target lost
				exampleTarget.addEventListener("targetLost", (event) => {
					console.log("target lost")
				})
			})
		</script>

		<script></script>
	</head>

	<body>
		<video
			id="video"
			style="
				position: absolute;
				width: 100%;
				height: 100%;
				top: 0;
				left: 0;
			"
			autoplay
		></video>
		<canvas
			id="canvas"
			style="
				position: absolute;
				width: 100%;
				height: 100%;
				top: 0;
				left: 0;
				display: none;
			"
		></canvas>
		<a-scene
			id="scene"
			mindar-image="imageTargetSrc: ./assets/easter-marker/photogame.mind"
			color-space="sRGB"
			vr-mode-ui="enabled: false"
			renderer="colorManagement: true; sortObjects: false; precision: high; logarithmicDepthBuffer: false; physicallyCorrectLights: false;"
		>
			<a-assets id="assets">
				<img
					id="card"
					src="./assets/easter-marker/GeoAR_Easter_easter_1-01.png"
				/>
				<img
					id="capsuleButton"
					src="./assets/photo-game-asset/btn_Capsule_green.png"
				/>
				<img
					id="funFactButton"
					src="./assets/photo-game-asset/btn_levelname_funfact_green.png"
				/>
				<img
					id="settingButton"
					src="./assets/photo-game-asset/btn_round_greenpng.png"
				/>
				<img
					id="blueButton"
					src="./assets/photo-game-asset/btn_square_blue.png"
				/>
				<img
					id="iconCamera"
					src="./assets/photo-game-asset/icon_camera.png"
				/>
				<img
					id="iconAbout"
					src="./assets/photo-game-asset/icon_about.png"
				/>
				<img
					id="iconSetting"
					src="./assets/photo-game-asset/icon_settings.png"
				/>
				<a-asset-item
					id="bunny"
					src="./assets/3dmodels/Bunny_01.gltf"
				></a-asset-item>
				<a-asset-item
					id="easter-egg"
					src="./assets/easter-egg/egg2.gltf"
				></a-asset-item>
				<a-asset-item
					id="flower"
					src="./assets/easter-egg/flower.gltf"
				></a-asset-item>

				<a-asset-item
					id="balloon"
					src="./assets/easter-egg/balloon.gltf"
				></a-asset-item>
			</a-assets>

			<!-- Add the raycaster component to the scene to enable mouse events on entities -->
			<a-camera
				id="camera"
				position="0 0 5"
				look-controls="enabled: false"
				cursor="fuse: false; rayOrigin: mouse;"
				raycaster="far: ${customFields.libVersion}; objects: .clickable"
			>
			</a-camera>

			<a-entity id="marker" mindar-image-target="targetIndex: 0">
				<a-entity
					id="info-button"
					class="clickable"
					position="-1.0 1.1 -0.3"
				>
					<a-image
						src="#funFactButton"
						height="0.4"
						width="1"
					></a-image>
				</a-entity>

				<a-entity
					id="setting-button"
					class="clickable"
					position="1.2 1.1 -0.3"
				>
					<a-image
						src="#settingButton"
						height="0.3"
						width="0.3"
					></a-image>
					<a-image
						src="#iconSetting"
						position="-0.04 -0.02 0.1"
						height="0.2"
						width="0.2"
					></a-image>
				</a-entity>

				<a-image
					id="flower-button"
					class="clickable"
					src="#capsuleButton"
					position="-1.2 -0.8 -0.3"
					height="0.3"
					width="0.5"
					flower-click
					><a-entity
						text="value: Flowers;"
						position="0.84 0 0"
						scale="2 2 2"
					></a-entity
				></a-image>

				<a-image
					id="bunny-button"
					class="clickable"
					src="#capsuleButton"
					position="-0.6 -0.8 -0.3"
					height="0.3"
					width="0.5"
					bunny-click
					><a-entity
						text="value: Bunnies;"
						position="0.84 0 0"
						scale="2 2 2"
					></a-entity
				></a-image>

				<a-entity class="clickable" position="0 -0.8 -0.3" photo-click>
					<a-image
						id="photo-button"
						src="#blueButton"
						height="0.5"
						width="0.5"
						class="clickable"
					></a-image>
					<a-image
						src="#iconCamera"
						position="0 0.05 0.1"
						height="0.2"
						width="0.2"
					></a-image>
				</a-entity>

				<a-image
					id="balloon-button"
					class="clickable"
					src="#capsuleButton"
					position="0.6 -0.8 -0.3"
					height="0.3"
					width="0.5"
					balloon-click
				>
					<a-entity
						text="value: Balloons;"
						position="0.84 0 0"
						scale="2 2 2"
					></a-entity
				></a-image>

				<a-image
					id="egg-button"
					class="clickable"
					src="#capsuleButton"
					position="1.2 -0.8 -0.3"
					height="0.3"
					width="0.5"
					egg-click
					><a-entity
						text="value: Eggs;"
						position="0.84 0 0"
						scale="2 2 2"
					></a-entity
				></a-image>

				<a-gltf-model
					id="bunnyModel"
					src="#bunny"
					scale="0.3 0.3 0.3"
					position="-0.9 -0.4 -0.3"
					visible="false"
				></a-gltf-model>

				<a-gltf-model
					id="flowerModel"
					src="#flower"
					scale="1 1 1"
					position="1.1 -0.4 -0.3"
					visible="false"
				></a-gltf-model>

				<a-gltf-model
					id="balloonModel"
					src="#balloon"
					scale="0.2 0.2 0.2"
					position="0.2 0.2 -0.3"
					visible="false"
				></a-gltf-model>

				<a-gltf-model
					id="eggModel"
					src="#easter-egg"
					scale="1 1 1"
					position="0.4 -0.4 -0.3"
					visible="false"
				></a-gltf-model>
			</a-entity>
		</a-scene>
	</body>
</html>
